<!DOCTYPE html>
<html lang="cs">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/webp" href="/cube.webp" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Nauč se Tělesa - Interaktivní výuka těles a geometrie"
    />
    <title>Nauč se Tělesa</title>

    <!-- Preload critical assets -->
    <link rel="preload" href="/cube.webp" as="image" type="image/webp" />

    <!-- Preconnect to supabase for faster auth -->
    <link rel="preconnect" href="https://bviuhriolcuvayzbgzum.supabase.co" />

    <!-- Inline critical CSS -->
    <style>
      body {
        margin: 0;
        padding: 0;
        background-color: #000;
        color: #fff;
        font-family: sans-serif;
      }

      #root {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        opacity: 0;
        transition: opacity 0.5s ease-in;
      }

      #loading-animation {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        background-color: #000;
        transition: opacity 0.3s ease-out;
      }

      #loading-animation svg {
        height: 150px;
        width: 150px;
      }

      #loading-title {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 20px;
      }

      /* Add an animated background for more visual appeal */
      @keyframes gradient {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      #loading-animation::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(120deg, #000000, #111827, #000000);
        background-size: 200% 200%;
        animation: gradient 5s ease infinite;
        z-index: -1;
      }
    </style>
  </head>
  <body>
    <!-- Enhanced loading animation -->
    <div id="loading-animation">
      <h1 id="loading-title">Nauč se Tělesa</h1>
      <svg viewBox="0 0 100 100">
        <g
          fill="none"
          stroke="#fff"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="6"
        >
          <!-- left line -->
          <path d="M 21 40 V 59">
            <animateTransform
              attributeName="transform"
              attributeType="XML"
              type="rotate"
              values="0 21 59; 180 21 59"
              dur="2s"
              repeatCount="indefinite"
            />
          </path>

          <!-- right line -->
          <path d="M 79 40 V 59">
            <animateTransform
              attributeName="transform"
              attributeType="XML"
              type="rotate"
              values="0 79 59; -180 79 59"
              dur="2s"
              repeatCount="indefinite"
            />
          </path>

          <!-- top line -->
          <path d="M 50 21 V 40">
            <animate
              attributeName="d"
              values="M 50 21 V 40; M 50 59 V 40"
              dur="2s"
              repeatCount="indefinite"
            />
          </path>

          <!-- btm line -->
          <path d="M 50 60 V 79">
            <animate
              attributeName="d"
              values="M 50 60 V 79; M 50 98 V 79"
              dur="2s"
              repeatCount="indefinite"
            />
          </path>

          <!-- top box -->
          <path d="M 50 21 L 79 40 L 50 60 L 21 40 Z">
            <animate
              attributeName="stroke"
              values="rgba(255,255,255,1); rgba(100,100,100,0)"
              dur="2s"
              repeatCount="indefinite"
            />
          </path>

          <!-- mid box -->
          <path d="M 50 40 L 79 59 L 50 79 L 21 59 Z" />

          <!-- btm box -->
          <path d="M 50 59 L 79 78 L 50 98 L 21 78 Z">
            <animate
              attributeName="stroke"
              values="rgba(100,100,100,0); rgba(255,255,255,1)"
              dur="2s"
              repeatCount="indefinite"
            />
          </path>
        </g>

        <!-- Group-level animation applied separately -->
        <animateTransform
          attributeName="transform"
          attributeType="XML"
          type="translate"
          values="0 0; 0 -19; 0 0"
          dur="2s"
          repeatCount="indefinite"
        />
      </svg>
    </div>

    <!-- Root element where React will mount -->
    <div id="root"></div>

    <!-- Improved loading animation control script -->
    <script>
      // Create a global function that can be called from your React app
      window.hideLoadingAnimation = function () {
        const loadingAnimation = document.getElementById("loading-animation");
        const rootElement = document.getElementById("root");

        if (loadingAnimation) {
          // Fade out loading animation
          loadingAnimation.style.opacity = "0";

          // Show root content
          if (rootElement) {
            rootElement.style.opacity = "1";
          }

          // Remove loading animation after transition completes
          setTimeout(() => {
            loadingAnimation.style.display = "none";
          }, 3000);
        }
      };

      // Safety fallback timeout - will hide animation after 15 seconds max
      window.loadingFallbackTimeout = setTimeout(() => {
        console.warn("React app load detection failed, using fallback timeout");
        window.hideLoadingAnimation();
      }, 15000);
    </script>

    <script type="module" src="/src/main.jsx" defer></script>
  </body>
</html>
